Note: I nuked what I had already made, if you want to see the old code look at the histroy.
